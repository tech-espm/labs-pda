
	<div class="form-group">
			<label for="nome">Nome da Narrativa: </label>
			<input id="nome" name="nome" maxlength="85" class="form-control" type="text" spellcheck="false" />
		</div>
	</div>
	
	<div class="card-body">
		<div class="form-group">
			<label for="descricao">Descrição da Narrativa: </label>		
            <textarea id ="descricao"  name="descricao" rows="10" cols="30" class="form-control" type="text" spellcheck="false"></textarea>
		</div>
	</div>
	</div>

<%- contentFor("scripts") %>

<script type="text/javascript">

	$("#form").validate({

		rules: {
			// Aqui o que vale é o name, não o id!
			nome: {
				required: true,
				minlength: 3
			},
			descricao: {
				required: true, 
				minlength: 10
			}			
		},
		submitHandler: function (form) {
			// Não pode simplesmente fazer submitHandler: criarPessoa, porque criarPessoa() é async... :(
				CriarNarrativa(form);
		}
	});

	async function CriarNarrativa(form) {
        let opcoes = {
			method: "POST",
			body: new FormData(form)
		};

		try {
			let response = await fetch("/api/narrativa/criar", opcoes);

            if (response.ok) {
				// Limpa os campos para facilitar a criação da próxima pessoa.
				resetForm("#form");

				alert("Narrativa criada com sucesso!");
			} else {
				alert("Erro ao criar a narrativa!");
			}
		} catch (ex) {
			alert("Erro de rede: " + ex.message);
		}
	}

</script>